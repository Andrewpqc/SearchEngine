
# Introduction
A simple application Which is based on Java VM, pylucene, python2.7 and provided movies information from douban by searching. Actually,it's my homework.

# Requirement
- python2.7
- Java VM(java jdk-9.0.1)
- Jcc
- Pylucene
- Flask framework

# Environmental configuration
## Install Java JDK
- download [JDK-9.0.1](http://www.oracle.com/technetwork/java/javase/downloads/jdk9-downloads-3848520.html), unzip it and move it to the place where you want it to.
- add the bin files to your PATH,and create `JAVA_HOME`,`CLASSPATH`,`JRE_HOME` Environment variables
``` bash
# add the following content to `/etc/profile` file
export JAVA_HOME=/usr/share/jdk-9.0.1 #change this to your jdk directory.
export JRE_HOME=${JAVA_HOME}/jre
export CLASSPATH=.:${JAVA_HOME}/lib:${JRE_HOME}/lib
export PATH=${JAVA_HOME}/bin:$PATH
```
- then,run the following command to reload this file.
``` bash
source /etc/profile
```
## Get and make Pylucene (significant !)
[PyLucene](https://lucene.apache.org/pylucene/) is a Python extension for accessing Java LuceneTM. Its goal is to allow you to use Lucene's text indexing and searching capabilities from Python.You can not to setup pylucene with pip/pip3 or something like that.Because the PyLucene Python extension is a Python module called lucene is machine-generated by [JCC](https://lucene.apache.org/pylucene/jcc/).PyLucene is built with JCC, a C++ code generator that makes it possible to call into Java classes from Python via Java's Native Invocation Interface (JNI). Sources for JCC are included with the PyLucene sources.

How to make and install pylucene? －> [here](http://blog.csdn.net/thuyx/article/details/69284170)
- install ant

which is used when make pylucene.
``` bash
$ sudo apt-get install ant
```

- edit `pylucene-4.10.1-1/jcc/setup.py`
```bash
JDK = {
       'darwin': JAVAHOME or JAVAFRAMEWORKS,
        'ipod': '/usr/include/gcc',
        'linux2': '/usr/share/jdk-9.0.1', #here is my OS and my JAVA_HOME.
        'sunos5': '/usr/jdk/instances/jdk1.6.0',
        'win32': JAVAHOME,
        'mingw32': JAVAHOME,
        'freebsd7': '/usr/local/diablo-jdk1.6.0'
 }
```
- build and setup jcc

if you want to setup it for python2,run the following commands.
```bash
$ python2 setup.py build
$ sudo python2 setup.py install
```
for python3,run these: 
``` bash
$ python3 setup.py build
$ sudo python3 setup.py install 
```
be patient! This step may takes a long time.

you may meet this when you run the first command above:
``` 
/usr/bin/ld: cannot find -lxxx
ld returned 1 exit status
```
this means that gcc can't find the `libxxx.so` package,then you can reference this [blog](http://calvinlee.github.io/blog/2012/04/15/ubuntu-gcc-cannot-find-lc/)

- edit `pylucene-4.10.1-1/Makefile`
choice your system, uncomment and edit JAVA_HOME like the following:

``` makefile
# Linux (Ubuntu 11.10 64-bit, Python 2.7.2, OpenJDK 1.7, setuptools 0.6.16)
# Be sure to also set JDK['linux2'] in jcc's setup.py to the JAVA_HOME value
# used below for ANT (and rebuild jcc after changing it).
PREFIX_PYTHON=/usr                                                 
ANT=JAVA_HOME=/usr/share/jdk-9.0.1 /usr/bin/ant 
PYTHON=$(PREFIX_PYTHON)/bin/python
JCC=$(PYTHON) -m jcc --shared
NUM_FILES=8

# comment/uncomment the desired/undesired optional contrib modules below
JARS+=$(ANALYZERS_JAR)          # many language analyzers
JARS+=$(MEMORY_JAR)             # single-document memory index
JARS+=$(HIGHLIGHTER_JAR)        # needs memory contrib
JARS+=$(EXTENSIONS_JAR)         # needs highlighter contrib
JARS+=$(QUERIES_JAR)            # regex and other contrib queries
JARS+=$(QUERYPARSER_JAR)        # query parser
JARS+=$(SANDBOX_JAR)            # needed by query parser

#if yo want use smart chinese you should uncomment it
#JARS+=$(SMARTCN_JAR)           # smart chinese analyzer
JARS+=$(STEMPEL_JAR)            # polish analyzer and stemmer
#JARS+=$(SPATIAL_JAR)           # spatial lucene
JARS+=$(GROUPING_JAR)           # grouping module
JARS+=$(JOIN_JAR)               # join module
JARS+=$(FACET_JAR)              # facet module
JARS+=$(SUGGEST_JAR)            # suggest/spell module
JARS+=$(EXPRESSIONS_JAR)        # expressions module
```

- make it
```
$ make
$ sudo make install
```
Be patient here!!!